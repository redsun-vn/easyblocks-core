{"version":3,"file":"index.cjs","sources":["../../../../src/compiler/schema/index.ts"],"sourcesContent":["import {\r\n  ComponentCollectionLocalisedSchemaProp,\r\n  ComponentCollectionSchemaProp,\r\n  ComponentPickerType,\r\n  ComponentSchemaProp,\r\n  ExternalSchemaProp,\r\n  Field,\r\n  SchemaProp as CoreSchemaProp,\r\n  SchemaPropShared,\r\n  LocalSchemaProp,\r\n} from \"../../types\";\r\nimport { EditorContextType, InternalComponentDefinition } from \"../types\";\r\n\r\ntype SchemaProp = CoreSchemaProp | Component$$$SchemaProp;\r\n\r\nexport type Component$$$SchemaProp = SchemaPropShared<\"component$$$\"> & {\r\n  definition: InternalComponentDefinition;\r\n  picker?: ComponentPickerType;\r\n  required?: boolean;\r\n};\r\n\r\nexport type InternalAnyField = InternalField & { [key: string]: any };\r\n\r\nexport type InternalAnyTinaField = InternalAnyField;\r\n\r\nexport type InternalField = Omit<Field, \"schemaProp\" | \"parse\" | \"format\"> & {\r\n  parse?: (value: any, name: string, field: InternalAnyField) => any;\r\n  format?: (value: any, name: string, field: InternalAnyField) => any;\r\n  schemaProp: Field[\"schemaProp\"] | Component$$$SchemaProp;\r\n};\r\n\r\nexport function isSchemaPropComponentCollectionLocalised(\r\n  schemaProp: SchemaProp\r\n): schemaProp is ComponentCollectionLocalisedSchemaProp {\r\n  return schemaProp.type === \"component-collection-localised\";\r\n}\r\n\r\nexport function isSchemaPropCollection(\r\n  schemaProp: SchemaProp\r\n): schemaProp is\r\n  | ComponentCollectionLocalisedSchemaProp\r\n  | ComponentCollectionSchemaProp {\r\n  return (\r\n    schemaProp.type === \"component-collection\" ||\r\n    schemaProp.type === \"component-collection-localised\"\r\n  );\r\n}\r\n\r\nexport function isSchemaPropComponent(\r\n  schemaProp: SchemaProp\r\n): schemaProp is ComponentSchemaProp {\r\n  return schemaProp.type === \"component\";\r\n}\r\n\r\nexport function isSchemaPropComponentOrComponentCollection(\r\n  schemaProp: SchemaProp\r\n): schemaProp is\r\n  | ComponentCollectionLocalisedSchemaProp\r\n  | ComponentCollectionSchemaProp\r\n  | ComponentSchemaProp {\r\n  return (\r\n    isSchemaPropCollection(schemaProp) || isSchemaPropComponent(schemaProp)\r\n  );\r\n}\r\n\r\nexport function isSchemaPropActionTextModifier(schemaProp: SchemaProp) {\r\n  return (\r\n    schemaProp.type === \"component\" &&\r\n    (schemaProp as ComponentSchemaProp).accepts.includes(\"actionTextModifier\")\r\n  );\r\n}\r\n\r\nexport function isSchemaPropTextModifier(schemaProp: SchemaProp) {\r\n  return (\r\n    schemaProp.type === \"component\" &&\r\n    (schemaProp as ComponentSchemaProp).accepts.includes(\"textModifier\")\r\n  );\r\n}\r\n\r\nconst internalTypes = new Set<SchemaProp[\"type\"]>([\r\n  \"string\",\r\n  \"number\",\r\n  \"boolean\",\r\n  \"select\",\r\n  \"radio-group\",\r\n  \"color\",\r\n  \"space\",\r\n  \"font\",\r\n  \"icon\",\r\n  \"text\",\r\n  \"component\",\r\n  \"component-collection\",\r\n  \"position\",\r\n  \"component$$$\",\r\n  \"component-collection-localised\",\r\n  \"aspectRatio\",\r\n  \"containerWidth\",\r\n  \"boxShadow\",\r\n]);\r\n\r\nexport function isCustomSchemaProp(\r\n  schemaProp: SchemaProp\r\n): schemaProp is ExternalSchemaProp | LocalSchemaProp {\r\n  return !internalTypes.has(schemaProp.type);\r\n}\r\n\r\nexport function isExternalSchemaProp(\r\n  schemaProp: SchemaProp,\r\n  types: EditorContextType[\"types\"]\r\n): schemaProp is ExternalSchemaProp {\r\n  return types[schemaProp.type] && types[schemaProp.type].type === \"external\";\r\n}\r\n\r\ntype TextModifierSchemaPropOptions = Omit<\r\n  ComponentSchemaProp,\r\n  \"type\" | \"accepts\" | \"hidden\"\r\n> &\r\n  Partial<Pick<ComponentSchemaProp, \"accepts\">>;\r\n\r\nexport function textModifierSchemaProp(\r\n  options: TextModifierSchemaPropOptions\r\n): ComponentSchemaProp {\r\n  return {\r\n    type: \"component\",\r\n    accepts: [\"textModifier\"],\r\n    // Schema props of type \"component\" are hidden by default\r\n    visible: true,\r\n    ...options,\r\n  };\r\n}\r\n"],"names":["isSchemaPropComponentCollectionLocalised","schemaProp","type","isSchemaPropCollection","isSchemaPropComponent","isSchemaPropComponentOrComponentCollection","isSchemaPropActionTextModifier","accepts","includes","isSchemaPropTextModifier","internalTypes","Set","isCustomSchemaProp","has","isExternalSchemaProp","types","textModifierSchemaProp","options","visible"],"mappings":";;;;;AA+BO,SAASA,wCAAwCA,CACtDC,UAAsB,EACgC;AACtD,EAAA,OAAOA,UAAU,CAACC,IAAI,KAAK,gCAAgC,CAAA;AAC7D,CAAA;AAEO,SAASC,sBAAsBA,CACpCF,UAAsB,EAGU;EAChC,OACEA,UAAU,CAACC,IAAI,KAAK,sBAAsB,IAC1CD,UAAU,CAACC,IAAI,KAAK,gCAAgC,CAAA;AAExD,CAAA;AAEO,SAASE,qBAAqBA,CACnCH,UAAsB,EACa;AACnC,EAAA,OAAOA,UAAU,CAACC,IAAI,KAAK,WAAW,CAAA;AACxC,CAAA;AAEO,SAASG,0CAA0CA,CACxDJ,UAAsB,EAIA;EACtB,OACEE,sBAAsB,CAACF,UAAU,CAAC,IAAIG,qBAAqB,CAACH,UAAU,CAAC,CAAA;AAE3E,CAAA;AAEO,SAASK,8BAA8BA,CAACL,UAAsB,EAAE;AACrE,EAAA,OACEA,UAAU,CAACC,IAAI,KAAK,WAAW,IAC9BD,UAAU,CAAyBM,OAAO,CAACC,QAAQ,CAAC,oBAAoB,CAAC,CAAA;AAE9E,CAAA;AAEO,SAASC,wBAAwBA,CAACR,UAAsB,EAAE;AAC/D,EAAA,OACEA,UAAU,CAACC,IAAI,KAAK,WAAW,IAC9BD,UAAU,CAAyBM,OAAO,CAACC,QAAQ,CAAC,cAAc,CAAC,CAAA;AAExE,CAAA;AAEA,MAAME,aAAa,GAAG,IAAIC,GAAG,CAAqB,CAChD,QAAQ,EACR,QAAQ,EACR,SAAS,EACT,QAAQ,EACR,aAAa,EACb,OAAO,EACP,OAAO,EACP,MAAM,EACN,MAAM,EACN,MAAM,EACN,WAAW,EACX,sBAAsB,EACtB,UAAU,EACV,cAAc,EACd,gCAAgC,EAChC,aAAa,EACb,gBAAgB,EAChB,WAAW,CACZ,CAAC,CAAA;AAEK,SAASC,kBAAkBA,CAChCX,UAAsB,EAC8B;EACpD,OAAO,CAACS,aAAa,CAACG,GAAG,CAACZ,UAAU,CAACC,IAAI,CAAC,CAAA;AAC5C,CAAA;AAEO,SAASY,oBAAoBA,CAClCb,UAAsB,EACtBc,KAAiC,EACC;AAClC,EAAA,OAAOA,KAAK,CAACd,UAAU,CAACC,IAAI,CAAC,IAAIa,KAAK,CAACd,UAAU,CAACC,IAAI,CAAC,CAACA,IAAI,KAAK,UAAU,CAAA;AAC7E,CAAA;AAQO,SAASc,sBAAsBA,CACpCC,OAAsC,EACjB;EACrB,OAAO;AACLf,IAAAA,IAAI,EAAE,WAAW;IACjBK,OAAO,EAAE,CAAC,cAAc,CAAC;AACzB;AACAW,IAAAA,OAAO,EAAE,IAAI;IACb,GAAGD,OAAAA;GACJ,CAAA;AACH;;;;;;;;;;;;"}