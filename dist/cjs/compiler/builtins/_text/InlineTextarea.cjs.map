{"version":3,"file":"InlineTextarea.cjs","sources":["../../../../../src/compiler/builtins/$text/InlineTextarea.tsx"],"sourcesContent":["import { dotNotationGet } from \"@/utils\";\r\nimport React, { ElementRef, useRef, useState } from \"react\";\r\nimport { flushSync } from \"react-dom\";\r\nimport TextareaAutosize from \"react-textarea-autosize\";\r\nimport { useTextValue } from \"../useTextValue\";\r\n\r\ninterface InlineTextProps {\r\n  path: string;\r\n  placeholder?: string;\r\n  stitches: any;\r\n}\r\n\r\nexport function InlineTextarea({\r\n  path,\r\n  placeholder,\r\n  stitches,\r\n}: InlineTextProps) {\r\n  const [isEnabled, setIsEnabled] = useState(false);\r\n  const textAreaRef = useRef<ElementRef<\"textarea\">>(null);\r\n\r\n  const {\r\n    form,\r\n    contextParams: { locale },\r\n    locales,\r\n  } = (window.parent as any).editorWindowAPI.editorContext;\r\n  const valuePath = `${path}.value`;\r\n  const value = dotNotationGet(form.values, valuePath);\r\n\r\n  const inputProps = useTextValue(\r\n    value,\r\n    (val: string | null) => {\r\n      form.change(valuePath, val);\r\n    },\r\n    locale,\r\n    locales,\r\n    placeholder\r\n  );\r\n\r\n  const css = stitches.css({\r\n    width: \"100%\",\r\n    wordWrap: \"break-word\",\r\n    display: \"block\",\r\n    fontSize: \"inherit\",\r\n    fontFamily: \"inherit\",\r\n    fontWeight: \"inherit\",\r\n    boxSizing: \"border-box\",\r\n    color: \"inherit\",\r\n    letterSpacing: \"inherit\",\r\n    lineHeight: \"inherit\",\r\n    margin: \"0 auto\",\r\n    maxWidth: \"inherit\",\r\n    textTransform: \"inherit\",\r\n    backgroundColor: \"inherit\",\r\n    textAlign: \"inherit\",\r\n    outline: \"none\",\r\n    resize: \"none\",\r\n    border: \"none\",\r\n    overflow: \"visible\",\r\n    position: \"relative\",\r\n    padding: 0,\r\n    \"-ms-overflow-style\": \"none\",\r\n    \"&::-webkit-scrollbar\": {\r\n      display: \"none\",\r\n    },\r\n    pointerEvents: isEnabled ? \"auto\" : \"none\",\r\n  })();\r\n\r\n  return (\r\n    <div\r\n      onMouseDown={(event) => {\r\n        if (event.detail === 2) {\r\n          event.preventDefault();\r\n\r\n          flushSync(() => {\r\n            setIsEnabled(true);\r\n          });\r\n\r\n          textAreaRef.current?.select();\r\n        }\r\n      }}\r\n    >\r\n      <TextareaAutosize\r\n        className={css}\r\n        rows={1}\r\n        {...inputProps}\r\n        ref={textAreaRef}\r\n        onMouseDown={(event) => {\r\n          if (isEnabled) {\r\n            event.stopPropagation();\r\n            return;\r\n          }\r\n        }}\r\n        onBlur={() => {\r\n          setIsEnabled(false);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["InlineTextarea","_ref","path","placeholder","stitches","isEnabled","setIsEnabled","useState","textAreaRef","useRef","form","contextParams","locale","locales","window","parent","editorWindowAPI","editorContext","valuePath","value","dotNotationGet","values","inputProps","useTextValue","val","change","css","width","wordWrap","display","fontSize","fontFamily","fontWeight","boxSizing","color","letterSpacing","lineHeight","margin","maxWidth","textTransform","backgroundColor","textAlign","outline","resize","border","overflow","position","padding","pointerEvents","React","createElement","onMouseDown","event","detail","preventDefault","flushSync","current","select","TextareaAutosize","_extends","className","rows","ref","stopPropagation","onBlur"],"mappings":"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"}