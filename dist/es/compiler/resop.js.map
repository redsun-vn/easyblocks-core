{"version":3,"file":"resop.js","sources":["../../../src/compiler/resop.ts"],"sourcesContent":["import {\r\n  responsiveValueForceGet,\r\n  responsiveValueNormalize,\r\n} from \"../responsiveness\";\r\nimport {\r\n  Devices,\r\n  NoCodeComponentStylesFunctionResult,\r\n  ResponsiveValue,\r\n  SchemaProp,\r\n  TrulyResponsiveValue,\r\n} from \"../types\";\r\nimport {\r\n  isSchemaPropCollection,\r\n  isSchemaPropComponent,\r\n  isSchemaPropComponentOrComponentCollection,\r\n} from \"./schema\";\r\nimport type { InternalComponentDefinition } from \"./types\";\r\n\r\ntype Config = { [key: string]: any };\r\n\r\n/**\r\n *  Input like: { breakpoint1: sth, breakpoint2: sth, breakpoint3: sth, ... }\r\n */\r\nfunction squashCSSResults(\r\n  scalarValues: { [key: string]: any },\r\n  devices: Devices,\r\n  disableNesting?: boolean\r\n): any {\r\n  // Let's check whether scalarValues represent object (for nesting) or a scalar value.\r\n  let objectsNum = 0;\r\n  let noObjectsNum = 0;\r\n  let arraysNum = 0;\r\n\r\n  for (const breakpointName in scalarValues) {\r\n    const val = scalarValues[breakpointName];\r\n\r\n    if (Array.isArray(val) && !disableNesting) {\r\n      arraysNum++;\r\n    } else if (\r\n      typeof val === \"object\" &&\r\n      val !== null &&\r\n      !Array.isArray(val) &&\r\n      !disableNesting\r\n    ) {\r\n      objectsNum++;\r\n    } else if (val !== null && val !== undefined) {\r\n      noObjectsNum++;\r\n    }\r\n  }\r\n\r\n  // Only one flag can be > 0!!! Otherwise breakpoints return incompatible types\r\n  if (\r\n    (objectsNum > 0 && (noObjectsNum > 0 || arraysNum > 0)) ||\r\n    (arraysNum > 0 && (noObjectsNum > 0 || objectsNum > 0)) ||\r\n    (noObjectsNum > 0 && (arraysNum > 0 || objectsNum > 0))\r\n  ) {\r\n    throw new Error(\r\n      \"This shouldn't happen. Mismatched types for different breakpoints!!!\"\r\n    );\r\n  }\r\n\r\n  if (arraysNum > 0) {\r\n    let biggestArrayLength = 0;\r\n\r\n    for (const breakpoint in scalarValues) {\r\n      biggestArrayLength = Math.max(\r\n        biggestArrayLength,\r\n        scalarValues[breakpoint].length\r\n      ); // {...allKeysObject, ...scalarValues[breakpoint]};\r\n    }\r\n\r\n    const ret: any[] = [];\r\n\r\n    for (let i = 0; i < biggestArrayLength; i++) {\r\n      const newScalarValues: { [key: string]: any } = {};\r\n\r\n      for (const breakpoint in scalarValues) {\r\n        let value: any = undefined;\r\n\r\n        if (scalarValues[breakpoint]) {\r\n          value = scalarValues[breakpoint][i];\r\n        }\r\n\r\n        newScalarValues[breakpoint] = value;\r\n      }\r\n\r\n      ret[i] = squashCSSResults(newScalarValues, devices);\r\n    }\r\n\r\n    return ret;\r\n  }\r\n\r\n  // If object -> recursion\r\n  if (objectsNum > 0) {\r\n    // allKeys is the object that has all the keys from all the scalar configs\r\n    let allKeysObject: { [key: string]: null } = {};\r\n\r\n    /**\r\n     * Scalar values are like:\r\n     *\r\n     * {\r\n     *    b1: { a: 10, b: 20 }\r\n     *    b2: { a: 100, c: 300 }\r\n     * }\r\n     */\r\n\r\n    for (const breakpoint in scalarValues) {\r\n      allKeysObject = { ...allKeysObject, ...scalarValues[breakpoint] };\r\n    }\r\n\r\n    // scalarValues.forEach(scalarConfig => {\r\n    //     allKeysObject = {...allKeysObject, ...scalarConfig};\r\n    // });\r\n\r\n    const allKeys = Object.keys(allKeysObject);\r\n    const ret: Config = {};\r\n\r\n    /**\r\n     * All keys are like: ['a', 'b', 'c']\r\n     *\r\n     * All used keys across all breakpoints\r\n     */\r\n\r\n    allKeys.forEach((key) => {\r\n      const newScalarValues: { [key: string]: any } = {};\r\n\r\n      for (const breakpoint in scalarValues) {\r\n        let value: any = undefined;\r\n\r\n        if (scalarValues[breakpoint]) {\r\n          value = scalarValues[breakpoint][key];\r\n        }\r\n\r\n        newScalarValues[breakpoint] = value;\r\n      }\r\n      /**\r\n       * newScalarValues values are like:\r\n       *\r\n       * For key 'a':\r\n       * {\r\n       *      b1: 10,\r\n       *      b2: 100\r\n       * }\r\n       *\r\n       * For key 'b':\r\n       * {\r\n       *     b1: 20,\r\n       *     b2: undefined\r\n       * }\r\n       *\r\n       */\r\n\r\n      /**\r\n       * For fonts we don't want nesting + recursion. We want entire object to be passed to results.\r\n       *\r\n       * Later, renderer must know how to render xfont property :)\r\n       *\r\n       * Otherwise, media query conflicts arise and bad values are set.\r\n       */\r\n      ret[key] = squashCSSResults(newScalarValues, devices, key === \"xfont\");\r\n    });\r\n\r\n    return ret;\r\n  }\r\n\r\n  // Here we are sure we have scalar value, not some object to be nested. We must do 2 things:\r\n  // - add \"unset\" instead of null / undefined\r\n  // - create ResponsiveValue and normalize\r\n\r\n  for (const key in scalarValues) {\r\n    if (scalarValues[key] === undefined || scalarValues[key] === null) {\r\n      scalarValues[key] = \"unset\";\r\n    }\r\n  }\r\n\r\n  // Values (non-objects -> no nesting)\r\n  return responsiveValueNormalize({ ...scalarValues, $res: true }, devices);\r\n}\r\n\r\nfunction scalarizeNonComponentProp(\r\n  value: any,\r\n  breakpoint: string,\r\n  schemaProp?: SchemaProp\r\n) {\r\n  if (schemaProp) {\r\n    // This function should never be called with component type\r\n    if (schemaProp.type.startsWith(\"component\")) {\r\n      throw new Error(\"unreachable\");\r\n    }\r\n\r\n    // Text values aren't responsive\r\n    if (schemaProp.type === \"text\") {\r\n      return value;\r\n    }\r\n\r\n    // other props are potentially responsive, so let's run responsiveValueGet\r\n    return responsiveValueForceGet(value, breakpoint);\r\n  }\r\n\r\n  // for context props we just treat them as responsive\r\n  return responsiveValueForceGet(value, breakpoint);\r\n}\r\n\r\nfunction scalarizeCollection(\r\n  configs: Config[],\r\n  breakpoint: string,\r\n  devices: Devices,\r\n  itemFieldsSchema: SchemaProp[]\r\n) {\r\n  return configs.map((child: any) => {\r\n    const scalarizedChild: Record<string, any> = { ...child };\r\n\r\n    for (const [key, value] of Object.entries(scalarizedChild)) {\r\n      const schemaProp = itemFieldsSchema.find((itemFieldSchemaProp) => {\r\n        return itemFieldSchemaProp.prop === key;\r\n      });\r\n\r\n      if (schemaProp) {\r\n        scalarizedChild[schemaProp.prop] = scalarizeNonComponentProp(\r\n          value,\r\n          breakpoint,\r\n          schemaProp\r\n        );\r\n      } else {\r\n        scalarizedChild[key] = scalarizeNonComponentProp(value, breakpoint);\r\n      }\r\n    }\r\n\r\n    return scalarizedChild;\r\n  });\r\n}\r\n\r\nexport function scalarizeConfig(\r\n  config: Config,\r\n  breakpoint: string,\r\n  devices: Devices,\r\n  schema: SchemaProp[]\r\n): any {\r\n  const ret: Record<string, any> = {};\r\n\r\n  /**\r\n   * There is a bit of chaos here. To understand what is happening, we must know what \"Config\" is in context of resop.\r\n   *\r\n   * Config is not a \"real\" config we're using in the Shopstory in almost all places. We're dealing here with \"intermediate compiled config\" used during compilation. What it means:\r\n   * 1. It has _component, _id, etc.\r\n   * 2. All the props from schema that are *not* components are compiled and are available.\r\n   * 3. All the props from schema that are components have only _component and _id (exception below)\r\n   * 4. component-collections has child Configs that have item props that are also compiled and are added *to the root level of the config*. They're simply context props. (IMPORTANT! -> localised is already non-localised ;p)\r\n   * 5. context props from compilation are also added to the config.\r\n   *\r\n   * PROBLEM:\r\n   *\r\n   * As long as we know the component \"own props\" (we have schema) and item props, we have no idea about context props types. It means that we can only blindly apply responsiveValueGet on them.\r\n   *\r\n   * SOLUTION:\r\n   *\r\n   * context props should be typed. Each editable component should have schema of own props and of context props.\r\n   *\r\n   */\r\n  for (const prop in config) {\r\n    const schemaProp = schema.find((x) => x.prop === prop);\r\n\r\n    // If schemaProp is defined, it means \"own prop\". Otherwise it must be a context prop (they're not \"typed\" yet and we don't have any information what types of context props we have)\r\n    if (schemaProp) {\r\n      // subcomponents don't get scalarized\r\n      if (isSchemaPropComponent(schemaProp)) {\r\n        ret[prop] = config[prop];\r\n      }\r\n      // component collection should have item props scalarized. We know the types of item props!\r\n      // component collection localised is already dealing with value that is NON-LOCALISED (it was flattened earlier)\r\n      else if (isSchemaPropCollection(schemaProp)) {\r\n        ret[prop] = scalarizeCollection(\r\n          config[prop],\r\n          breakpoint,\r\n          devices,\r\n          schemaProp.itemFields || []\r\n        );\r\n      } else {\r\n        ret[prop] = scalarizeNonComponentProp(\r\n          config[prop],\r\n          breakpoint,\r\n          schemaProp\r\n        );\r\n      }\r\n    } else {\r\n      // context props automatically get scalarized\r\n      ret[prop] = scalarizeNonComponentProp(config[prop], breakpoint);\r\n    }\r\n  }\r\n\r\n  return ret;\r\n}\r\n\r\nfunction getUndefinedBreakpoints(\r\n  resVal: TrulyResponsiveValue<any>,\r\n  devices: Devices\r\n) {\r\n  const undefinedBreakpoints: string[] = [];\r\n  devices.forEach((device) => {\r\n    if (resVal[device.id] === undefined) {\r\n      undefinedBreakpoints.push(device.id);\r\n    }\r\n  });\r\n  return undefinedBreakpoints;\r\n}\r\n\r\nfunction hasDefinedBreakpoints(\r\n  resVal: TrulyResponsiveValue<any>,\r\n  devices: Devices\r\n) {\r\n  const undefinedBreakpoints = getUndefinedBreakpoints(resVal, devices);\r\n  return undefinedBreakpoints.length < devices.length;\r\n}\r\n\r\ntype Resop2Result = Required<NoCodeComponentStylesFunctionResult>;\r\n\r\nexport function resop2(\r\n  input: {\r\n    values: Record<string, ResponsiveValue<any>>;\r\n    params: Record<string, ResponsiveValue<any>>;\r\n  },\r\n  callback: (\r\n    scalarInput: {\r\n      values: Record<string, any>;\r\n      params: Record<string, any>;\r\n    },\r\n    breakpointIndex: string\r\n  ) => NoCodeComponentStylesFunctionResult,\r\n  devices: Devices,\r\n  componentDefinition?: InternalComponentDefinition\r\n): Resop2Result {\r\n  const schema = componentDefinition?.schema ?? [];\r\n\r\n  // Decompose config into scalar configs\r\n  const scalarInputs: Record<\r\n    string,\r\n    {\r\n      values: Record<string, unknown>;\r\n      params: Record<string, unknown>;\r\n    }\r\n  > = {};\r\n\r\n  devices.forEach((device) => {\r\n    scalarInputs[device.id] = {\r\n      params: scalarizeConfig(input.params, device.id, devices, []),\r\n      values: scalarizeConfig(input.values, device.id, devices, schema),\r\n    };\r\n  });\r\n\r\n  const scalarOutputs: Record<string, NoCodeComponentStylesFunctionResult> = {};\r\n\r\n  // run callback for scalar configs\r\n  devices.forEach((device) => {\r\n    scalarOutputs[device.id] = callback(scalarInputs[device.id], device.id);\r\n  });\r\n\r\n  /**\r\n   * Let's first squash all __props, components and item props\r\n   */\r\n\r\n  const componentPropNames: Record<string, Set<string>> = {};\r\n  const componentItemPropsNamesAndLength: Record<\r\n    string,\r\n    { lengths: Set<number>; names: Set<string> }\r\n  > = {};\r\n  const propNames: Set<string> = new Set();\r\n\r\n  // Let's add keys\r\n  schema.forEach((schemaProp) => {\r\n    if (isSchemaPropComponentOrComponentCollection(schemaProp)) {\r\n      componentPropNames[schemaProp.prop] = new Set();\r\n    }\r\n    if (isSchemaPropCollection(schemaProp)) {\r\n      componentItemPropsNamesAndLength[schemaProp.prop] = {\r\n        lengths: new Set(),\r\n        names: new Set(),\r\n      };\r\n    }\r\n  });\r\n\r\n  // Let's find all output prop names\r\n  devices.forEach((device) => {\r\n    // prop names\r\n    const propsObject = scalarOutputs[device.id].props ?? {};\r\n\r\n    if (typeof propsObject !== \"object\" || propsObject === null) {\r\n      throw new Error(\r\n        `__props must be object, it is not for breakpoint: ${device.id}`\r\n      );\r\n    }\r\n\r\n    for (const propName in propsObject) {\r\n      propNames.add(propName);\r\n    }\r\n\r\n    // component prop names\r\n    schema.forEach((schemaProp) => {\r\n      if (isSchemaPropComponentOrComponentCollection(schemaProp)) {\r\n        const componentObject: Record<string, any> =\r\n          scalarOutputs[device.id].components?.[schemaProp.prop] ?? {};\r\n\r\n        if (typeof componentObject !== \"object\" || componentObject === null) {\r\n          throw new Error(\r\n            `resop error: component must be undefined or an object, it is not for device ${device.id} and prop ${schemaProp.prop}. Template: ${componentDefinition?.id}`\r\n          );\r\n        }\r\n\r\n        for (const key in componentObject) {\r\n          if (key === \"itemProps\") {\r\n            continue;\r\n          }\r\n          componentPropNames[schemaProp.prop].add(key);\r\n        }\r\n\r\n        if (isSchemaPropCollection(schemaProp)) {\r\n          const itemPropsArray = componentObject.itemProps ?? [];\r\n\r\n          if (!Array.isArray(itemPropsArray)) {\r\n            throw new Error(\r\n              `resop error: item props must be undefined or an array (${schemaProp.prop}). Template: ${componentDefinition?.id}`\r\n            );\r\n          }\r\n\r\n          itemPropsArray.forEach((itemObject: any, index: number) => {\r\n            if (typeof itemObject !== \"object\" || itemObject === null) {\r\n              throw new Error(\r\n                `resop error: item in itemProps array must be object (${schemaProp.prop}.itemProps.${index}). Template: ${componentDefinition?.id}`\r\n              );\r\n            }\r\n\r\n            for (const key in itemObject) {\r\n              componentItemPropsNamesAndLength[schemaProp.prop].names.add(key);\r\n            }\r\n          });\r\n\r\n          componentItemPropsNamesAndLength[schemaProp.prop].lengths.add(\r\n            itemPropsArray.length\r\n          );\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  // Let's verify array lengths\r\n  for (const componentName in componentItemPropsNamesAndLength) {\r\n    const lengths = componentItemPropsNamesAndLength[componentName].lengths;\r\n    if (lengths.size > 1) {\r\n      throw new Error(\r\n        `resop: incompatible item props arrays length for component: ${componentName}. Template: ${componentDefinition?.id}`\r\n      );\r\n    }\r\n\r\n    const length = Array.from(lengths)[0];\r\n\r\n    // If non-zero length, then there are extra requirements\r\n    if (length > 0) {\r\n      const itemsLength = (input.values as any)[componentName].length;\r\n\r\n      if (itemsLength === 0 ? length > 1 : itemsLength !== length) {\r\n        throw new Error(\r\n          `resop: item props arrays length incompatible with items length for component: ${componentName}. Template: ${componentDefinition?.id}`\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  // Let's compress\r\n  const output: Resop2Result = {\r\n    props: {},\r\n    components: {},\r\n    styled: {},\r\n  };\r\n\r\n  // squash props\r\n  propNames.forEach((propName) => {\r\n    const squashedValue: TrulyResponsiveValue<any> = {\r\n      $res: true,\r\n    };\r\n\r\n    devices.forEach((device) => {\r\n      squashedValue[device.id] = scalarOutputs[device.id]?.props?.[propName];\r\n    });\r\n\r\n    if (hasDefinedBreakpoints(squashedValue, devices)) {\r\n      const undefinedBreakpoints = getUndefinedBreakpoints(\r\n        squashedValue,\r\n        devices\r\n      );\r\n      if (undefinedBreakpoints.length > 0) {\r\n        throw new Error(\r\n          `resop: undefined value (breakpoints: ${undefinedBreakpoints}) for __props.${propName}. Template: ${componentDefinition?.id}`\r\n        );\r\n      }\r\n      output.props[propName] = responsiveValueNormalize(squashedValue, devices); // props should be normalized\r\n    }\r\n  });\r\n\r\n  // Squash components\r\n  for (const componentName in componentPropNames) {\r\n    output.components[componentName] = {};\r\n\r\n    componentPropNames[componentName].forEach((componentPropName) => {\r\n      const squashedValue: TrulyResponsiveValue<any> = {\r\n        $res: true,\r\n      };\r\n      devices.forEach((device) => {\r\n        squashedValue[device.id] =\r\n          scalarOutputs[device.id].components?.[componentName]?.[\r\n            componentPropName\r\n          ];\r\n      });\r\n\r\n      if (hasDefinedBreakpoints(squashedValue, devices)) {\r\n        const undefinedBreakpoints = getUndefinedBreakpoints(\r\n          squashedValue,\r\n          devices\r\n        );\r\n        if (undefinedBreakpoints.length > 0) {\r\n          throw new Error(\r\n            `resop: undefined value (breakpoints ${undefinedBreakpoints}) for ${componentName}.${componentPropName}. Template: ${componentDefinition?.id}`\r\n          );\r\n        }\r\n        output.components[componentName][componentPropName] = squashedValue;\r\n      }\r\n    });\r\n  }\r\n\r\n  // Squash item props\r\n  for (const componentName in componentItemPropsNamesAndLength) {\r\n    output.components[componentName].itemProps = [];\r\n\r\n    const length = Array.from(\r\n      componentItemPropsNamesAndLength[componentName].lengths\r\n    )[0];\r\n\r\n    for (let i = 0; i < length; i++) {\r\n      output.components[componentName].itemProps![i] = {};\r\n\r\n      componentItemPropsNamesAndLength[componentName].names.forEach(\r\n        (itemPropName) => {\r\n          const squashedValue: TrulyResponsiveValue<any> = {\r\n            $res: true,\r\n          };\r\n\r\n          devices.forEach((device) => {\r\n            squashedValue[device.id] =\r\n              scalarOutputs[device.id].components?.[componentName]?.itemProps?.[\r\n                i\r\n              ]?.[itemPropName];\r\n          });\r\n\r\n          if (hasDefinedBreakpoints(squashedValue, devices)) {\r\n            const undefinedBreakpoints = getUndefinedBreakpoints(\r\n              squashedValue,\r\n              devices\r\n            );\r\n            if (undefinedBreakpoints.length > 0) {\r\n              throw new Error(\r\n                `resop: undefined value (breakpoints ${undefinedBreakpoints}) for ${componentName}.${i}.${itemPropName}. Template: ${componentDefinition?.id}`\r\n              );\r\n            }\r\n            output.components[componentName].itemProps![i][itemPropName] =\r\n              squashedValue;\r\n          }\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  const styledOnlyScalarOutputs = Object.fromEntries(\r\n    Object.entries(scalarOutputs).map(([deviceId, result]) => [\r\n      deviceId,\r\n      result.styled,\r\n    ])\r\n  );\r\n\r\n  output.styled = squashCSSResults(styledOnlyScalarOutputs, devices);\r\n\r\n  return output;\r\n}\r\n"],"names":["squashCSSResults","scalarValues","devices","disableNesting","objectsNum","noObjectsNum","arraysNum","breakpointName","val","Array","isArray","undefined","Error","biggestArrayLength","breakpoint","Math","max","length","ret","i","newScalarValues","value","allKeysObject","allKeys","Object","keys","forEach","key","responsiveValueNormalize","$res","scalarizeNonComponentProp","schemaProp","type","startsWith","responsiveValueForceGet","scalarizeCollection","configs","itemFieldsSchema","map","child","scalarizedChild","entries","find","itemFieldSchemaProp","prop","scalarizeConfig","config","schema","x","isSchemaPropComponent","isSchemaPropCollection","itemFields","getUndefinedBreakpoints","resVal","undefinedBreakpoints","device","id","push","hasDefinedBreakpoints","resop2","input","callback","componentDefinition","scalarInputs","params","values","scalarOutputs","componentPropNames","componentItemPropsNamesAndLength","propNames","Set","isSchemaPropComponentOrComponentCollection","lengths","names","propsObject","props","propName","add","componentObject","components","itemPropsArray","itemProps","itemObject","index","componentName","size","from","itemsLength","output","styled","squashedValue","componentPropName","itemPropName","styledOnlyScalarOutputs","fromEntries","_ref","deviceId","result"],"mappings":"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"}