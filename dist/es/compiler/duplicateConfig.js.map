{"version":3,"file":"duplicateConfig.js","sources":["../../../src/compiler/duplicateConfig.ts"],"sourcesContent":["import { deepClone, uniqueId } from \"@/utils\";\r\nimport { NoCodeComponentEntry } from \"../types\";\r\nimport { configTraverse } from \"./configTraverse\";\r\nimport { traverseComponents } from \"./traverseComponents\";\r\nimport { CompilationContextType } from \"./types\";\r\n\r\nexport function duplicateConfig<\r\n  ConfigType extends NoCodeComponentEntry = NoCodeComponentEntry\r\n>(inputConfig: ConfigType, compilationContext: CompilationContextType) {\r\n  // deep copy first\r\n  const config = deepClone(inputConfig);\r\n\r\n  // refresh component ids\r\n  traverseComponents(config, compilationContext, ({ componentConfig }) => {\r\n    componentConfig._id = uniqueId();\r\n  });\r\n\r\n  // every text must get new local id\r\n  configTraverse(config, compilationContext, ({ value, schemaProp }) => {\r\n    if (schemaProp.type === \"text\") {\r\n      value.id = \"local.\" + uniqueId();\r\n    }\r\n  });\r\n\r\n  return config;\r\n}\r\n"],"names":["duplicateConfig","inputConfig","compilationContext","config","deepClone","traverseComponents","_ref","componentConfig","_id","uniqueId","configTraverse","_ref2","value","schemaProp","type","id"],"mappings":";;;;;;AAMO,SAASA,eAAeA,CAE7BC,WAAuB,EAAEC,kBAA0C,EAAE;AACrE;AACA,EAAA,MAAMC,MAAM,GAAGC,SAAS,CAACH,WAAW,CAAC,CAAA;;AAErC;AACAI,EAAAA,kBAAkB,CAACF,MAAM,EAAED,kBAAkB,EAAEI,IAAA,IAAyB;IAAA,IAAxB;AAAEC,MAAAA,eAAAA;AAAgB,KAAC,GAAAD,IAAA,CAAA;AACjEC,IAAAA,eAAe,CAACC,GAAG,GAAGC,QAAQ,EAAE,CAAA;AAClC,GAAC,CAAC,CAAA;;AAEF;AACAC,EAAAA,cAAc,CAACP,MAAM,EAAED,kBAAkB,EAAES,KAAA,IAA2B;IAAA,IAA1B;MAAEC,KAAK;AAAEC,MAAAA,UAAAA;AAAW,KAAC,GAAAF,KAAA,CAAA;AAC/D,IAAA,IAAIE,UAAU,CAACC,IAAI,KAAK,MAAM,EAAE;AAC9BF,MAAAA,KAAK,CAACG,EAAE,GAAG,QAAQ,GAAGN,QAAQ,EAAE,CAAA;AAClC,KAAA;AACF,GAAC,CAAC,CAAA;AAEF,EAAA,OAAON,MAAM,CAAA;AACf;;;;"}