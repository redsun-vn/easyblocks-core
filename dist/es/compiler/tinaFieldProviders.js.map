{"version":3,"file":"tinaFieldProviders.js","sources":["../../../src/compiler/tinaFieldProviders.ts"],"sourcesContent":["import { assertDefined } from \"@/utils\";\r\nimport {\r\n  AnyTinaField,\r\n  BooleanSchemaProp,\r\n  ComponentCollectionLocalisedSchemaProp,\r\n  ComponentCollectionSchemaProp,\r\n  ComponentSchemaProp,\r\n  ExternalSchemaProp,\r\n  LocalSchemaProp,\r\n  LocalTextReference,\r\n  NoCodeComponentEntry,\r\n  NumberSchemaProp,\r\n  PositionSchemaProp,\r\n  RadioGroupSchemaProp,\r\n  SchemaProp,\r\n  SelectSchemaProp,\r\n  StringSchemaProp,\r\n  TextSchemaProp,\r\n  TokenSchemaProp,\r\n} from \"../types\";\r\nimport { EditorContextType } from \"./types\";\r\n\r\nfunction getCommonFieldProps(\r\n  schemaProp: SchemaProp\r\n): Pick<\r\n  AnyTinaField,\r\n  | \"label\"\r\n  | \"name\"\r\n  | \"group\"\r\n  | \"schemaProp\"\r\n  | \"description\"\r\n  | \"isLabelHidden\"\r\n  | \"layout\"\r\n  | \"params\"\r\n> {\r\n  const label = schemaProp.label || schemaProp.prop;\r\n  const group = schemaProp.group || \"Properties\";\r\n\r\n  return {\r\n    label,\r\n    name: schemaProp.prop,\r\n    group,\r\n    schemaProp,\r\n    description: schemaProp.description,\r\n    isLabelHidden: schemaProp.isLabelHidden,\r\n    layout: schemaProp.layout,\r\n    params: \"params\" in schemaProp ? schemaProp.params : undefined,\r\n  };\r\n}\r\n\r\ntype FieldProvider<\r\n  S extends Exclude<\r\n    SchemaProp,\r\n    | ComponentSchemaProp\r\n    | ComponentCollectionSchemaProp\r\n    | ComponentCollectionLocalisedSchemaProp\r\n  >,\r\n  Value = Exclude<S[\"defaultValue\"], undefined>\r\n> = (\r\n  schemaProp: S,\r\n  editorContext: EditorContextType,\r\n  value: Value\r\n) => AnyTinaField;\r\n\r\ntype TinaFieldProviders = {\r\n  text: FieldProvider<TextSchemaProp>;\r\n  string: FieldProvider<StringSchemaProp>;\r\n  number: FieldProvider<NumberSchemaProp>;\r\n  boolean: FieldProvider<BooleanSchemaProp>;\r\n  select: FieldProvider<SelectSchemaProp>;\r\n  \"radio-group\": FieldProvider<RadioGroupSchemaProp>;\r\n  component: FieldProvider<ComponentSchemaProp, [] | [NoCodeComponentEntry]>;\r\n  \"component-collection\": FieldProvider<\r\n    ComponentCollectionSchemaProp,\r\n    Array<NoCodeComponentEntry>\r\n  >;\r\n  \"component-collection-localised\": FieldProvider<ComponentCollectionLocalisedSchemaProp>;\r\n  component$$$: FieldProvider<ComponentSchemaProp>;\r\n  external: FieldProvider<ExternalSchemaProp>;\r\n  custom: FieldProvider<ExternalSchemaProp | LocalSchemaProp | TokenSchemaProp>;\r\n  position: FieldProvider<PositionSchemaProp>;\r\n};\r\n\r\nconst tinaFieldProviders: TinaFieldProviders = {\r\n  text: (schemaProp, _, value) => {\r\n    if (!isValueLocalTextReference(value) && typeof value !== \"string\") {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"external\",\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"text\",\r\n      name: schemaProp.prop,\r\n      normalize: schemaProp.normalize,\r\n    };\r\n  },\r\n  number: (schemaProp) => {\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"number\",\r\n      step: 1,\r\n      min: schemaProp.params?.min,\r\n      max: schemaProp.params?.max,\r\n    };\r\n  },\r\n  string: (schemaProp) => {\r\n    if (schemaProp.responsive) {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"responsive2\",\r\n        subComponent: \"text\",\r\n        normalize: schemaProp.params?.normalize,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"text\",\r\n      normalize: schemaProp.params?.normalize,\r\n    };\r\n  },\r\n  boolean: (schemaProp) => {\r\n    if (schemaProp.responsive) {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"responsive2\",\r\n        subComponent: \"toggle\",\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"toggle\",\r\n    };\r\n  },\r\n  select: (schemaProp) => {\r\n    if (schemaProp.responsive) {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"responsive2\",\r\n        subComponent: \"select\",\r\n        options: schemaProp.params.options,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"select\",\r\n      options: schemaProp.params.options,\r\n    };\r\n  },\r\n  \"radio-group\": (schemaProp) => {\r\n    if (schemaProp.responsive) {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"responsive2\",\r\n        subComponent: \"radio-group\",\r\n        options: schemaProp.params.options,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"radio-group\",\r\n      options: schemaProp.params.options,\r\n    };\r\n  },\r\n  component: (schemaProp) => {\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"block\",\r\n      schemaProp,\r\n    };\r\n  },\r\n  \"component-collection\": () => {\r\n    throw new Error(\"component-collection is not yet supported in sidebar\");\r\n  },\r\n\r\n  \"component-collection-localised\": () => {\r\n    throw new Error(\r\n      \"component-collection-localised is not yet supported in sidebar\"\r\n    );\r\n  },\r\n  component$$$: (schemaProp) => {\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"identity\",\r\n      schemaProp,\r\n    };\r\n  },\r\n  external: (schemaProp, editorContext) => {\r\n    const externalTypeDefinition = editorContext.types[schemaProp.type] as\r\n      | Extract<EditorContextType[\"types\"][string], { type: \"external\" }>\r\n      | undefined;\r\n\r\n    if (!externalTypeDefinition) {\r\n      throw new Error(`Can't find definition for type \"${schemaProp.type}\"`);\r\n    }\r\n\r\n    if (schemaProp.responsive) {\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        component: \"responsive2\",\r\n        subComponent: \"external\",\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"external\",\r\n    };\r\n  },\r\n  position: (schemaProp) => {\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      component: \"responsive2\",\r\n      subComponent: \"position\",\r\n    };\r\n  },\r\n  custom: (schemaProp, editorContext, value) => {\r\n    const customTypeDefinition = editorContext.types[schemaProp.type];\r\n\r\n    if (!customTypeDefinition) {\r\n      throw new Error(`Can't find definition for type \"${schemaProp.type}\"`);\r\n    }\r\n\r\n    if (customTypeDefinition.type === \"external\") {\r\n      return tinaFieldProviders.external(schemaProp, editorContext, value);\r\n    }\r\n\r\n    if (customTypeDefinition.type === \"token\") {\r\n      let tokens = assertDefined(\r\n        editorContext.theme[customTypeDefinition.token],\r\n        `Missing token values within the Easyblocks config for \"${customTypeDefinition.token}\"`\r\n      );\r\n\r\n      if (\r\n        \"params\" in schemaProp &&\r\n        schemaProp.params &&\r\n        \"prefix\" in schemaProp.params &&\r\n        typeof schemaProp.params.prefix === \"string\"\r\n      ) {\r\n        // Copy tokens to prevent mutating original tokens\r\n        tokens = { ...tokens };\r\n\r\n        for (const key in tokens) {\r\n          if (!key.startsWith(schemaProp.params.prefix + \".\")) {\r\n            delete tokens[key];\r\n          } else {\r\n            tokens[key] = {\r\n              ...tokens[key],\r\n              label: key.split(`${schemaProp.params.prefix}.`)[1],\r\n            };\r\n          }\r\n        }\r\n      }\r\n\r\n      const commonTokenFieldProps = {\r\n        tokens,\r\n        allowCustom: !!customTypeDefinition.allowCustom,\r\n        extraValues:\r\n          \"params\" in schemaProp &&\r\n            schemaProp.params &&\r\n            \"extraValues\" in schemaProp.params\r\n            ? schemaProp.params.extraValues\r\n            : undefined,\r\n      };\r\n\r\n      if (customTypeDefinition.responsiveness === \"never\") {\r\n        return {\r\n          ...getCommonFieldProps(schemaProp),\r\n          component: \"token\",\r\n          ...commonTokenFieldProps,\r\n        };\r\n      }\r\n\r\n      return {\r\n        ...getCommonFieldProps(schemaProp),\r\n        // Token fields are always responsive\r\n        component: \"responsive2\",\r\n        subComponent: \"token\",\r\n        ...commonTokenFieldProps,\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...getCommonFieldProps(schemaProp),\r\n      ...(customTypeDefinition.responsiveness === \"always\" ||\r\n        (customTypeDefinition.responsiveness === \"optional\" &&\r\n          schemaProp.responsive)\r\n        ? {\r\n          component: \"responsive2\",\r\n          subComponent: \"local\",\r\n        }\r\n        : {\r\n          component: \"local\",\r\n        }),\r\n    };\r\n  },\r\n};\r\n\r\nexport function getTinaField<T extends SchemaProp>(\r\n  schemaProp: T,\r\n  editorContext: EditorContextType,\r\n  value: any\r\n) {\r\n  const fieldProvider =\r\n    editorContext.types[schemaProp.type] && schemaProp.type !== \"text\"\r\n      ? tinaFieldProviders.custom\r\n      : (tinaFieldProviders as any)[schemaProp.type];\r\n\r\n  return fieldProvider(schemaProp, editorContext, value);\r\n}\r\n\r\nfunction isValueLocalTextReference(\r\n  value: unknown\r\n): value is LocalTextReference {\r\n  if (!(typeof value === \"object\" && value !== null)) {\r\n    return false;\r\n  }\r\n\r\n  if (\r\n    !(\r\n      \"id\" in value &&\r\n      typeof (value as { id: unknown }).id === \"string\" &&\r\n      (value as { id: string }).id.startsWith(\"local.\")\r\n    )\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  if (!(\"value\" in value)) {\r\n    return false;\r\n  }\r\n\r\n  if (\r\n    !(\r\n      \"widgetId\" in value &&\r\n      typeof (value as { widgetId: unknown }).widgetId === \"string\" &&\r\n      (value as { widgetId: string }).widgetId === \"@easyblocks/local-text\"\r\n    )\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n"],"names":["getCommonFieldProps","schemaProp","label","prop","group","name","description","isLabelHidden","layout","params","undefined","tinaFieldProviders","text","_","value","isValueLocalTextReference","component","normalize","number","step","min","max","string","responsive","subComponent","boolean","select","options","component-collection","Error","component-collection-localised","component$$$","external","editorContext","externalTypeDefinition","types","type","position","custom","customTypeDefinition","tokens","assertDefined","theme","token","prefix","key","startsWith","split","commonTokenFieldProps","allowCustom","extraValues","responsiveness","getTinaField","fieldProvider","id","widgetId"],"mappings":"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"}