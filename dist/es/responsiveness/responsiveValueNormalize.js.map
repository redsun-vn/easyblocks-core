{"version":3,"file":"responsiveValueNormalize.js","sources":["../../../src/responsiveness/responsiveValueNormalize.ts"],"sourcesContent":["import { Devices, ResponsiveValue, TrulyResponsiveValue } from \"../types\";\nimport { isTrulyResponsiveValue } from \"./isTrulyResponsiveValue\";\n\nexport function responsiveValueNormalize<T>(\n  arg: ResponsiveValue<T>,\n  devices: Devices\n): ResponsiveValue<T> {\n  if (!isTrulyResponsiveValue(arg)) {\n    return arg;\n  }\n\n  let previousVal: any = undefined;\n\n  const ret: TrulyResponsiveValue<any> = {\n    $res: true,\n  };\n\n  let numberOfDefinedValues = 0;\n\n  for (let i = devices.length - 1; i >= 0; i--) {\n    const breakpoint = devices[i].id;\n    const val = arg[breakpoint];\n\n    // TODO: if values are objects, it's to do\n    if (typeof val === \"object\" && val !== null) {\n      if (JSON.stringify(val) !== JSON.stringify(previousVal)) {\n        ret[breakpoint] = val;\n        previousVal = val;\n        numberOfDefinedValues++;\n      }\n    } else {\n      if (val !== undefined && val !== previousVal) {\n        ret[breakpoint] = val;\n        previousVal = val;\n        numberOfDefinedValues++;\n      }\n    }\n\n    // [x, null, null, y] => [x, y]\n    if (i < devices.length - 1) {\n      const nextBreakpoint = devices[i + 1].id;\n\n      if (\n        numberOfDefinedValues === 1 &&\n        ret[breakpoint] === undefined &&\n        ret[nextBreakpoint] !== undefined\n      ) {\n        ret[breakpoint] = ret[nextBreakpoint];\n        delete ret[nextBreakpoint];\n      }\n    }\n  }\n\n  if (numberOfDefinedValues === 1) {\n    return ret[devices[0].id];\n  }\n\n  return ret;\n}\n"],"names":["responsiveValueNormalize","arg","devices","isTrulyResponsiveValue","previousVal","undefined","ret","$res","numberOfDefinedValues","i","length","breakpoint","id","val","JSON","stringify","nextBreakpoint"],"mappings":";;;AAGO,SAASA,wBAAwBA,CACtCC,GAAuB,EACvBC,OAAgB,EACI;AACpB,EAAA,IAAI,CAACC,sBAAsB,CAACF,GAAG,CAAC,EAAE;AAChC,IAAA,OAAOA,GAAG,CAAA;AACZ,GAAA;EAEA,IAAIG,WAAgB,GAAGC,SAAS,CAAA;AAEhC,EAAA,MAAMC,GAA8B,GAAG;AACrCC,IAAAA,IAAI,EAAE,IAAA;GACP,CAAA;EAED,IAAIC,qBAAqB,GAAG,CAAC,CAAA;AAE7B,EAAA,KAAK,IAAIC,CAAC,GAAGP,OAAO,CAACQ,MAAM,GAAG,CAAC,EAAED,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;AAC5C,IAAA,MAAME,UAAU,GAAGT,OAAO,CAACO,CAAC,CAAC,CAACG,EAAE,CAAA;AAChC,IAAA,MAAMC,GAAG,GAAGZ,GAAG,CAACU,UAAU,CAAC,CAAA;;AAE3B;IACA,IAAI,OAAOE,GAAG,KAAK,QAAQ,IAAIA,GAAG,KAAK,IAAI,EAAE;AAC3C,MAAA,IAAIC,IAAI,CAACC,SAAS,CAACF,GAAG,CAAC,KAAKC,IAAI,CAACC,SAAS,CAACX,WAAW,CAAC,EAAE;AACvDE,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGE,GAAG,CAAA;AACrBT,QAAAA,WAAW,GAAGS,GAAG,CAAA;AACjBL,QAAAA,qBAAqB,EAAE,CAAA;AACzB,OAAA;AACF,KAAC,MAAM;AACL,MAAA,IAAIK,GAAG,KAAKR,SAAS,IAAIQ,GAAG,KAAKT,WAAW,EAAE;AAC5CE,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGE,GAAG,CAAA;AACrBT,QAAAA,WAAW,GAAGS,GAAG,CAAA;AACjBL,QAAAA,qBAAqB,EAAE,CAAA;AACzB,OAAA;AACF,KAAA;;AAEA;AACA,IAAA,IAAIC,CAAC,GAAGP,OAAO,CAACQ,MAAM,GAAG,CAAC,EAAE;MAC1B,MAAMM,cAAc,GAAGd,OAAO,CAACO,CAAC,GAAG,CAAC,CAAC,CAACG,EAAE,CAAA;AAExC,MAAA,IACEJ,qBAAqB,KAAK,CAAC,IAC3BF,GAAG,CAACK,UAAU,CAAC,KAAKN,SAAS,IAC7BC,GAAG,CAACU,cAAc,CAAC,KAAKX,SAAS,EACjC;AACAC,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGL,GAAG,CAACU,cAAc,CAAC,CAAA;QACrC,OAAOV,GAAG,CAACU,cAAc,CAAC,CAAA;AAC5B,OAAA;AACF,KAAA;AACF,GAAA;EAEA,IAAIR,qBAAqB,KAAK,CAAC,EAAE;IAC/B,OAAOF,GAAG,CAACJ,OAAO,CAAC,CAAC,CAAC,CAACU,EAAE,CAAC,CAAA;AAC3B,GAAA;AAEA,EAAA,OAAON,GAAG,CAAA;AACZ;;;;"}