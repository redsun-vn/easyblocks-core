{"version":3,"file":"responsiveValueNormalize.js","sources":["../../../src/responsiveness/responsiveValueNormalize.ts"],"sourcesContent":["import { Devices, ResponsiveValue, TrulyResponsiveValue } from \"../types\";\r\nimport { isTrulyResponsiveValue } from \"./isTrulyResponsiveValue\";\r\n\r\nexport function responsiveValueNormalize<T>(\r\n  arg: ResponsiveValue<T>,\r\n  devices: Devices\r\n): ResponsiveValue<T> {\r\n  if (!isTrulyResponsiveValue(arg)) {\r\n    return arg;\r\n  }\r\n\r\n  let previousVal: any = undefined;\r\n\r\n  const ret: TrulyResponsiveValue<any> = {\r\n    $res: true,\r\n  };\r\n\r\n  let numberOfDefinedValues = 0;\r\n\r\n  for (let i = devices.length - 1; i >= 0; i--) {\r\n    const breakpoint = devices[i].id;\r\n    const val = arg[breakpoint];\r\n\r\n    // TODO: if values are objects, it's to do\r\n    if (typeof val === \"object\" && val !== null) {\r\n      if (JSON.stringify(val) !== JSON.stringify(previousVal)) {\r\n        ret[breakpoint] = val;\r\n        previousVal = val;\r\n        numberOfDefinedValues++;\r\n      }\r\n    } else {\r\n      if (val !== undefined && val !== previousVal) {\r\n        ret[breakpoint] = val;\r\n        previousVal = val;\r\n        numberOfDefinedValues++;\r\n      }\r\n    }\r\n\r\n    // [x, null, null, y] => [x, y]\r\n    if (i < devices.length - 1) {\r\n      const nextBreakpoint = devices[i + 1].id;\r\n\r\n      if (\r\n        numberOfDefinedValues === 1 &&\r\n        ret[breakpoint] === undefined &&\r\n        ret[nextBreakpoint] !== undefined\r\n      ) {\r\n        ret[breakpoint] = ret[nextBreakpoint];\r\n        delete ret[nextBreakpoint];\r\n      }\r\n    }\r\n  }\r\n\r\n  if (numberOfDefinedValues === 1) {\r\n    return ret[devices[0].id];\r\n  }\r\n\r\n  return ret;\r\n}\r\n"],"names":["responsiveValueNormalize","arg","devices","isTrulyResponsiveValue","previousVal","undefined","ret","$res","numberOfDefinedValues","i","length","breakpoint","id","val","JSON","stringify","nextBreakpoint"],"mappings":";;;AAGO,SAASA,wBAAwBA,CACtCC,GAAuB,EACvBC,OAAgB,EACI;AACpB,EAAA,IAAI,CAACC,sBAAsB,CAACF,GAAG,CAAC,EAAE;AAChC,IAAA,OAAOA,GAAG,CAAA;AACZ,GAAA;EAEA,IAAIG,WAAgB,GAAGC,SAAS,CAAA;AAEhC,EAAA,MAAMC,GAA8B,GAAG;AACrCC,IAAAA,IAAI,EAAE,IAAA;GACP,CAAA;EAED,IAAIC,qBAAqB,GAAG,CAAC,CAAA;AAE7B,EAAA,KAAK,IAAIC,CAAC,GAAGP,OAAO,CAACQ,MAAM,GAAG,CAAC,EAAED,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;AAC5C,IAAA,MAAME,UAAU,GAAGT,OAAO,CAACO,CAAC,CAAC,CAACG,EAAE,CAAA;AAChC,IAAA,MAAMC,GAAG,GAAGZ,GAAG,CAACU,UAAU,CAAC,CAAA;;AAE3B;IACA,IAAI,OAAOE,GAAG,KAAK,QAAQ,IAAIA,GAAG,KAAK,IAAI,EAAE;AAC3C,MAAA,IAAIC,IAAI,CAACC,SAAS,CAACF,GAAG,CAAC,KAAKC,IAAI,CAACC,SAAS,CAACX,WAAW,CAAC,EAAE;AACvDE,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGE,GAAG,CAAA;AACrBT,QAAAA,WAAW,GAAGS,GAAG,CAAA;AACjBL,QAAAA,qBAAqB,EAAE,CAAA;AACzB,OAAA;AACF,KAAC,MAAM;AACL,MAAA,IAAIK,GAAG,KAAKR,SAAS,IAAIQ,GAAG,KAAKT,WAAW,EAAE;AAC5CE,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGE,GAAG,CAAA;AACrBT,QAAAA,WAAW,GAAGS,GAAG,CAAA;AACjBL,QAAAA,qBAAqB,EAAE,CAAA;AACzB,OAAA;AACF,KAAA;;AAEA;AACA,IAAA,IAAIC,CAAC,GAAGP,OAAO,CAACQ,MAAM,GAAG,CAAC,EAAE;MAC1B,MAAMM,cAAc,GAAGd,OAAO,CAACO,CAAC,GAAG,CAAC,CAAC,CAACG,EAAE,CAAA;AAExC,MAAA,IACEJ,qBAAqB,KAAK,CAAC,IAC3BF,GAAG,CAACK,UAAU,CAAC,KAAKN,SAAS,IAC7BC,GAAG,CAACU,cAAc,CAAC,KAAKX,SAAS,EACjC;AACAC,QAAAA,GAAG,CAACK,UAAU,CAAC,GAAGL,GAAG,CAACU,cAAc,CAAC,CAAA;QACrC,OAAOV,GAAG,CAACU,cAAc,CAAC,CAAA;AAC5B,OAAA;AACF,KAAA;AACF,GAAA;EAEA,IAAIR,qBAAqB,KAAK,CAAC,EAAE;IAC/B,OAAOF,GAAG,CAACJ,OAAO,CAAC,CAAC,CAAC,CAACU,EAAE,CAAC,CAAA;AAC3B,GAAA;AAEA,EAAA,OAAON,GAAG,CAAA;AACZ;;;;"}