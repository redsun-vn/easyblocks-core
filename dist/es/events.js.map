{"version":3,"file":"events.js","sources":["../../src/events.ts"],"sourcesContent":["import { serialize } from \"@/utils\";\r\nimport { NoCodeComponentEntry, SchemaProp } from \"./types\";\r\nimport { Component$$$SchemaProp } from \"./compiler/schema\";\r\n\r\ntype EasyblocksEditorEventData<\r\n  Type extends `@easyblocks-editor/${string}${string}`,\r\n  Payload = never\r\n> = Payload extends never ? { type: Type } : { type: Type; payload: Payload };\r\n\r\ntype InferShopstoryEditorEventData<Event> = Event extends MessageEvent<\r\n  EasyblocksEditorEventData<infer Type, infer Payload>\r\n>\r\n  ? EasyblocksEditorEventData<Type, Payload>\r\n  : never;\r\n\r\ntype SelectionFramePositionChangedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/selection-frame-position-changed\",\r\n    {\r\n      target: DOMRect;\r\n      container?: DOMRect;\r\n    }\r\n  >\r\n>;\r\n\r\nfunction selectionFramePositionChanged(\r\n  target: DOMRect,\r\n  container?: DOMRect\r\n): InferShopstoryEditorEventData<SelectionFramePositionChangedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/selection-frame-position-changed\",\r\n    payload: {\r\n      target,\r\n      container,\r\n    },\r\n  };\r\n}\r\n\r\ntype RichTextChangedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/rich-text-changed\",\r\n    {\r\n      prop: \"font\" | \"color\" | \"TextWrapper\";\r\n      schemaProp: SchemaProp | Component$$$SchemaProp;\r\n      values: Array<Record<string, any> | [] | [NoCodeComponentEntry]>;\r\n    }\r\n  >\r\n>;\r\n\r\nfunction richTextChangedEvent(\r\n  payload: InferShopstoryEditorEventData<RichTextChangedEvent>[\"payload\"]\r\n): InferShopstoryEditorEventData<RichTextChangedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/rich-text-changed\",\r\n    payload: serialize(payload),\r\n  };\r\n}\r\n\r\ntype ComponentPickerOpenedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/component-picker-opened\",\r\n    { path: string }\r\n  >\r\n>;\r\n\r\nfunction componentPickerOpened(\r\n  path: string\r\n): InferShopstoryEditorEventData<ComponentPickerOpenedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/component-picker-opened\",\r\n    payload: {\r\n      path,\r\n    },\r\n  };\r\n}\r\n\r\ntype ComponentPickerClosedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/component-picker-closed\",\r\n    { config?: NoCodeComponentEntry }\r\n  >\r\n>;\r\n\r\nfunction componentPickerClosed(\r\n  config?: NoCodeComponentEntry\r\n): InferShopstoryEditorEventData<ComponentPickerClosedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/component-picker-closed\",\r\n    payload: {\r\n      config,\r\n    },\r\n  };\r\n}\r\n\r\ntype ItemInsertedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/item-inserted\",\r\n    { name: string; index: number; block: NoCodeComponentEntry }\r\n  >\r\n>;\r\n\r\nfunction itemInserted(\r\n  payload: InferShopstoryEditorEventData<ItemInsertedEvent>[\"payload\"]\r\n): InferShopstoryEditorEventData<ItemInsertedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/item-inserted\",\r\n    payload,\r\n  };\r\n}\r\n\r\ntype ItemMovedEvent = MessageEvent<\r\n  EasyblocksEditorEventData<\r\n    \"@easyblocks-editor/item-moved\",\r\n    {\r\n      fromPath: string;\r\n      toPath: string;\r\n      placement?: \"before\" | \"after\";\r\n    }\r\n  >\r\n>;\r\n\r\nfunction itemMoved(\r\n  payload: InferShopstoryEditorEventData<ItemMovedEvent>[\"payload\"]\r\n): InferShopstoryEditorEventData<ItemMovedEvent> {\r\n  return {\r\n    type: \"@easyblocks-editor/item-moved\",\r\n    payload,\r\n  };\r\n}\r\n\r\nexport {\r\n  componentPickerClosed,\r\n  componentPickerOpened,\r\n  itemInserted,\r\n  itemMoved,\r\n  richTextChangedEvent,\r\n  selectionFramePositionChanged,\r\n};\r\nexport type {\r\n  ComponentPickerClosedEvent,\r\n  ComponentPickerOpenedEvent,\r\n  InferShopstoryEditorEventData,\r\n  ItemInsertedEvent,\r\n  ItemMovedEvent,\r\n  RichTextChangedEvent,\r\n  SelectionFramePositionChangedEvent,\r\n  EasyblocksEditorEventData,\r\n};\r\n"],"names":["selectionFramePositionChanged","target","container","type","payload","richTextChangedEvent","serialize","componentPickerOpened","path","componentPickerClosed","config","itemInserted","itemMoved"],"mappings":";;;AAyBA,SAASA,6BAA6BA,CACpCC,MAAe,EACfC,SAAmB,EACgD;EACnE,OAAO;AACLC,IAAAA,IAAI,EAAE,qDAAqD;AAC3DC,IAAAA,OAAO,EAAE;MACPH,MAAM;AACNC,MAAAA,SAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AAaA,SAASG,oBAAoBA,CAC3BD,OAAuE,EAClB;EACrD,OAAO;AACLD,IAAAA,IAAI,EAAE,sCAAsC;IAC5CC,OAAO,EAAEE,SAAS,CAACF,OAAO,CAAA;GAC3B,CAAA;AACH,CAAA;AASA,SAASG,qBAAqBA,CAC5BC,IAAY,EAC+C;EAC3D,OAAO;AACLL,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE;AACPI,MAAAA,IAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AASA,SAASC,qBAAqBA,CAC5BC,MAA6B,EAC8B;EAC3D,OAAO;AACLP,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE;AACPM,MAAAA,MAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AASA,SAASC,YAAYA,CACnBP,OAAoE,EAClB;EAClD,OAAO;AACLD,IAAAA,IAAI,EAAE,kCAAkC;AACxCC,IAAAA,OAAAA;GACD,CAAA;AACH,CAAA;AAaA,SAASQ,SAASA,CAChBR,OAAiE,EAClB;EAC/C,OAAO;AACLD,IAAAA,IAAI,EAAE,+BAA+B;AACrCC,IAAAA,OAAAA;GACD,CAAA;AACH;;;;"}