{"version":3,"file":"events.js","sources":["../../src/events.ts"],"sourcesContent":["import { serialize } from \"@/utils\";\nimport { NoCodeComponentEntry, SchemaProp } from \"./types\";\nimport { Component$$$SchemaProp } from \"./compiler/schema\";\n\ntype EasyblocksEditorEventData<\n  Type extends `@easyblocks-editor/${string}${string}`,\n  Payload = never\n> = Payload extends never ? { type: Type } : { type: Type; payload: Payload };\n\ntype InferShopstoryEditorEventData<Event> = Event extends MessageEvent<\n  EasyblocksEditorEventData<infer Type, infer Payload>\n>\n  ? EasyblocksEditorEventData<Type, Payload>\n  : never;\n\ntype SelectionFramePositionChangedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/selection-frame-position-changed\",\n    {\n      target: DOMRect;\n      container?: DOMRect;\n    }\n  >\n>;\n\nfunction selectionFramePositionChanged(\n  target: DOMRect,\n  container?: DOMRect\n): InferShopstoryEditorEventData<SelectionFramePositionChangedEvent> {\n  return {\n    type: \"@easyblocks-editor/selection-frame-position-changed\",\n    payload: {\n      target,\n      container,\n    },\n  };\n}\n\ntype RichTextChangedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/rich-text-changed\",\n    {\n      prop: \"font\" | \"color\" | \"TextWrapper\";\n      schemaProp: SchemaProp | Component$$$SchemaProp;\n      values: Array<Record<string, any> | [] | [NoCodeComponentEntry]>;\n    }\n  >\n>;\n\nfunction richTextChangedEvent(\n  payload: InferShopstoryEditorEventData<RichTextChangedEvent>[\"payload\"]\n): InferShopstoryEditorEventData<RichTextChangedEvent> {\n  return {\n    type: \"@easyblocks-editor/rich-text-changed\",\n    payload: serialize(payload),\n  };\n}\n\ntype ComponentPickerOpenedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/component-picker-opened\",\n    { path: string }\n  >\n>;\n\nfunction componentPickerOpened(\n  path: string\n): InferShopstoryEditorEventData<ComponentPickerOpenedEvent> {\n  return {\n    type: \"@easyblocks-editor/component-picker-opened\",\n    payload: {\n      path,\n    },\n  };\n}\n\ntype ComponentPickerClosedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/component-picker-closed\",\n    { config?: NoCodeComponentEntry }\n  >\n>;\n\nfunction componentPickerClosed(\n  config?: NoCodeComponentEntry\n): InferShopstoryEditorEventData<ComponentPickerClosedEvent> {\n  return {\n    type: \"@easyblocks-editor/component-picker-closed\",\n    payload: {\n      config,\n    },\n  };\n}\n\ntype ItemInsertedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/item-inserted\",\n    { name: string; index: number; block: NoCodeComponentEntry }\n  >\n>;\n\nfunction itemInserted(\n  payload: InferShopstoryEditorEventData<ItemInsertedEvent>[\"payload\"]\n): InferShopstoryEditorEventData<ItemInsertedEvent> {\n  return {\n    type: \"@easyblocks-editor/item-inserted\",\n    payload,\n  };\n}\n\ntype ItemMovedEvent = MessageEvent<\n  EasyblocksEditorEventData<\n    \"@easyblocks-editor/item-moved\",\n    {\n      fromPath: string;\n      toPath: string;\n      placement?: \"before\" | \"after\";\n    }\n  >\n>;\n\nfunction itemMoved(\n  payload: InferShopstoryEditorEventData<ItemMovedEvent>[\"payload\"]\n): InferShopstoryEditorEventData<ItemMovedEvent> {\n  return {\n    type: \"@easyblocks-editor/item-moved\",\n    payload,\n  };\n}\n\nexport {\n  componentPickerClosed,\n  componentPickerOpened,\n  itemInserted,\n  itemMoved,\n  richTextChangedEvent,\n  selectionFramePositionChanged,\n};\nexport type {\n  ComponentPickerClosedEvent,\n  ComponentPickerOpenedEvent,\n  InferShopstoryEditorEventData,\n  ItemInsertedEvent,\n  ItemMovedEvent,\n  RichTextChangedEvent,\n  SelectionFramePositionChangedEvent,\n  EasyblocksEditorEventData,\n};\n"],"names":["selectionFramePositionChanged","target","container","type","payload","richTextChangedEvent","serialize","componentPickerOpened","path","componentPickerClosed","config","itemInserted","itemMoved"],"mappings":";;;AAyBA,SAASA,6BAA6BA,CACpCC,MAAe,EACfC,SAAmB,EACgD;EACnE,OAAO;AACLC,IAAAA,IAAI,EAAE,qDAAqD;AAC3DC,IAAAA,OAAO,EAAE;MACPH,MAAM;AACNC,MAAAA,SAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AAaA,SAASG,oBAAoBA,CAC3BD,OAAuE,EAClB;EACrD,OAAO;AACLD,IAAAA,IAAI,EAAE,sCAAsC;IAC5CC,OAAO,EAAEE,SAAS,CAACF,OAAO,CAAA;GAC3B,CAAA;AACH,CAAA;AASA,SAASG,qBAAqBA,CAC5BC,IAAY,EAC+C;EAC3D,OAAO;AACLL,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE;AACPI,MAAAA,IAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AASA,SAASC,qBAAqBA,CAC5BC,MAA6B,EAC8B;EAC3D,OAAO;AACLP,IAAAA,IAAI,EAAE,4CAA4C;AAClDC,IAAAA,OAAO,EAAE;AACPM,MAAAA,MAAAA;AACF,KAAA;GACD,CAAA;AACH,CAAA;AASA,SAASC,YAAYA,CACnBP,OAAoE,EAClB;EAClD,OAAO;AACLD,IAAAA,IAAI,EAAE,kCAAkC;AACxCC,IAAAA,OAAAA;GACD,CAAA;AACH,CAAA;AAaA,SAASQ,SAASA,CAChBR,OAAiE,EAClB;EAC/C,OAAO;AACLD,IAAAA,IAAI,EAAE,+BAA+B;AACrCC,IAAAA,OAAAA;GACD,CAAA;AACH;;;;"}